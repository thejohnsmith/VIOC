<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Valvoline Instant Oil Change | Oil Change Locations | Oil Change Coupons</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="styles/mobile.css" rel="stylesheet" type="text/css">
    <!-- Header bar colors for Android, iOS and Win. -->
    <meta name="theme-color" content="#0281aa">
    <meta name="apple-mobile-web-app-status-bar-style" content="#0281aa">
    <meta name="msapplication-navbutton-color" content="#0281aa">
</head>

<body>
    <header class="page-header">
        Valvoline Instant Oil Change
    </header>

<article class="page-main">
    <section id="contact">
        <section class="address-section">
        </section>
    </section>

    <section id="offers">
        <section class="coupons-section">
        </section>
    </section>

    <section id="services" class="js-hidden">
        <section class="services-section">
        </section>
    </section>
    <section id="store" class="js-hidden">
        <section class="mobile-store-hours-section" id="store-hours">

        </section>
        <section id="store-services">

            <div class="ad">
                <img id="ctlStore_rptFeatures_ctl00_ImageFeature" alt="" src="images/feature_speedyRewards.jpg" style="width:114px;border-width:0px;">
                Earn Speedy Rewards Points at this location!
            </div>

            <div class="ad">
                <img id="ctlStore_rptFeatures_ctl01_ImageFeature" alt="" src="images/feature_fleetServices.jpg" style="width:114px;border-width:0px;">
                Easy, Speedy Service for Fleets
            </div>

            <div class="clear"></div>
        </section>
    </section>
</article>
        <script type="text/javascript" src="scripts/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js"></script>
        <script type="text/javascript" src="scripts/couponPageController.js"></script>
        <script>
            /* Epsilon 2016 */
            if (typeof couponPageController.controller.init() == 'function') {
                console.warn('CouponPageController is ready.');
                couponPageController.controller.init();
            }
        </script>
        <script type="text/javascript">
            (function($) {

                $('a.service').on('click', function(e) {

                    e.preventDefault();

                    if ($(this).parent().next('.details').hasClass('open')) {

                        $(this).parent().next('.details').slideUp('fast', function() {

                            $(this).removeClass('open').removeAttr('style');

                        });
                    } else {

                        $(this).parent().next('.details').slideDown('fast', function() {

                            $(this).addClass('open').removeAttr('style');

                        }).siblings('.details').slideUp('fast', function() {

                            $(this).removeClass('open').removeAttr('style');

                        });

                    }

                });

            })(jQuery);

        (function() {

            if (location.hash != "") {

                document.getElementById('offers').style.display = "none";
                document.getElementById('store').style.display = "none";
                document.getElementById('services').style.display = "none";

                // document.getElementById((location.hash).replace('#', '')).style.display = "block";
            }

        })();
    </script>
    <footer>
        <nav>
            <a href="http://coupons.vioc.com/marketing/m/Mobile.aspx?rid=MXqC_GLSj&amp;p=26&amp;s=70066&amp;v=20160128HTG&amp;utm_campaign=Lapsed2&amp;utm_source=VIOC&amp;utm_medium=Email&amp;utm_term=BasicBlue&amp;cid=63654&amp;mid=274295899#offers" id="nav-offers"
                class="current">Offers</a>
            <span class="divider"></span>
            <a href="http://coupons.vioc.com/marketing/m/Mobile.aspx?rid=MXqC_GLSj&amp;p=26&amp;s=70066&amp;v=20160128HTG&amp;utm_campaign=Lapsed2&amp;utm_source=VIOC&amp;utm_medium=Email&amp;utm_term=BasicBlue&amp;cid=63654&amp;mid=274295899#store" id="nav-store">
              Store</a>
            <span class="divider"></span>
            <a href="http://coupons.vioc.com/marketing/m/Mobile.aspx?rid=MXqC_GLSj&amp;p=26&amp;s=70066&amp;v=20160128HTG&amp;utm_campaign=Lapsed2&amp;utm_source=VIOC&amp;utm_medium=Email&amp;utm_term=BasicBlue&amp;cid=63654&amp;mid=274295899#services" id="nav-services">
              Services</a>
        </nav>
    </footer>
    <script type="text/javascript">
        // (function() {
        //     if (location.hash != "") document.getElementById('nav-' + (location.hash).replace('#', '')).setAttribute('class', 'current');
        //     else document.getElementById('nav-offers').setAttribute('class', 'current');
        // })();
    </script>
    <script type="text/javascript">
        (function() {

            $('footer nav a').on('click', function(e) {

                e.preventDefault();

                // location.hash = $(this).attr('href');

                $(this).addClass('current').siblings('a').removeClass('current');

                switch ($(this).attr('id')) {

                    case "nav-offers":
                        $('section#offers').show().siblings('section:not("#contact")').hide();
                        window.scrollTo(0, 0);
                        break;

                    case "nav-store":
                        $('section#store').show().siblings('section:not("#contact")').hide();
                        window.scrollTo(0, 0);
                        break;

                    case "nav-services":
                        $('section#services').show().siblings('section:not("#contact")').hide();
                        window.scrollTo(0, 0);
                        break;
                }

            });

        })();

        $(".print").click(function() {
            var a = [];
            $(".coupon_couponCode").each(function() {
                a.push($(this).text())
            });
            dataLayer.push({
                event: "coupon",
                eventAction: "print - promo code",
                eventLabel: a.join("/")
            })
        });
        $(document).ready(function() {
            $("#submit").on("keypress", function(a) {
                a = a.which;
                13 == a && logLocationSearch()
            });
            $("#submit").on("click", function(a) {
                console.log("Search Button Clicked");
                logLocationSearch()
            });
            $("#ctl00_FooterContent2_connect1_btnSignUp").on("click", function(a) {
                console.log("Button Clicked");
                logSubmission()
            })
        });

        function logLocationSearch() {
            var a = new RegExp(/Enter your address or ZIP code|^$/),
                b = $("#location_textinput").val();
            console.log("Location Search");
            console.log("Default Values: " + a.test(b));
            a.test(b) || (console.log("Pushing location - search to Data Layer"), dataLayer.push({
                event: "location",
                eventAction: "search",
                eventLabel: $("#location_textinput").val()
            }))
        }

        function logSubmission() {
            var a = new RegExp(/^[+a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/),
                b = $("div.form input.email-input").val(),
                c = new RegExp(/^\d{5}$/),
                d = $("div.form input.zip-input").val();
            console.log($("div.form input.email-input").val());
            console.log(a.test(b));
            console.log($("div.form input.zip-input").val());
            console.log(c.test(d));
            a.test(b) && c.test(d) && (console.log("Pushing signup - email to Data Layer"), dataLayer.push({
                event: "signup",
                eventAction: "email",
                eventLabel: "coupons.vioc.com/SEM - Connect With Us"
            }))
        };
    </script>
    <script type="text/javascript" id="">
        $(".coupon-form .button-default, .coupon__offer__open, #signup__input__form #signup__button, #print-coupon, .coupon__offer__close").on("click", function(a) {
            a.preventDefault()
        });
        if ($(".coupon-form").length) {
            $(".coupon-form").unbind("invalid-form.validate");
            $(".coupon-form").each(function() {
                $(this).bind("invalid-form.validate", function(a, c) {
                    var b = $(a.currentTarget).find("input").not(".ignore"),
                        d = c.numberOfInvalids();
                    d && (b.hasClass("signup__sms") && ga("send", {
                        hitType: "event",
                        eventCategory: "Coupon",
                        eventAction: "sms",
                        eventLabel: "validation"
                    }), b.hasClass("signup__email") && ga("send", {
                        hitType: "event",
                        eventCategory: "Coupon",
                        eventAction: "email",
                        eventLabel: "validation"
                    }))
                })
            });
            var submitCoupon =
                function(a) {
                    var c = $(a).find("input").not(".ignore"),
                        b = $(a).closest(".coupon");
                    a = b.find(".send__offers");
                    var d = a.data("submitType");
                    a = encodeURIComponent(b.data("image-url"));
                    var e = {};
                    "email" == d ? (b = encodeURIComponent(b.find(".signup__email").val()), e = {
                        offer_image_url: a,
                        email: b
                    }) : "sms" == d && (b = encodeURIComponent(b.find(".signup__sms").val()), e = {
                        offer_image_url: a,
                        phone: b
                    });
                    $.ajax({
                        url: "https://utilities.vioc.com/api/v1/marketing/sendoffer",
                        data: e,
                        dataType: "json",
                        type: "post",
                        beforeSend: function(a) {
                            a.setRequestHeader("Authorization",
                                "Basic Y2F0YWx5c3QtYXBpOmNAdEBseXN0");
                            a.setRequestHeader("Accept", "application/json")
                        },
                        success: function(a) {
                            $("#couponSuccessModal").modal("show");
                            c.hasClass("signup__sms") && ga("send", {
                                hitType: "event",
                                eventCategory: "Coupon",
                                eventAction: "sms",
                                eventLabel: "success"
                            });
                            c.hasClass("signup__email") && ga("send", {
                                hitType: "event",
                                eventCategory: "Coupon",
                                eventAction: "email",
                                eventLabel: "success"
                            })
                        },
                        error: function(a) {
                            $("#couponErrorModal").modal("show");
                            c.hasClass("signup__sms") && ga("send", {
                                hitType: "event",
                                eventCategory: "Coupon",
                                eventAction: "sms",
                                eventLabel: "error"
                            });
                            c.hasClass("signup__email") && ga("send", {
                                hitType: "event",
                                eventCategory: "Coupon",
                                eventAction: "email",
                                eventLabel: "error"
                            })
                        }
                    })
                };
            $(".coupon-form").each(function() {
                $(this).validate().settings.submitHandler = function(a) {
                    submitCoupon(a)
                }
            })
        }
        if ($("#signup__input__form").length) {
            $("#signup__input__form").unbind("invalid-form.validate");
            $("#signup__input__form").bind("invalid-form.validate", function(a, c) {
                var b = $(a.currentTarget).find("input").not(".ignore"),
                    d = c.numberOfInvalids();
                d && (b.hasClass("signup__sms") && ga("send", {
                    hitType: "event",
                    eventCategory: "Signup",
                    eventAction: "sms",
                    eventLabel: "validation"
                }), b.hasClass("signup__email") && ga("send", {
                    hitType: "event",
                    eventCategory: "Signup",
                    eventAction: "email",
                    eventLabel: "validation"
                }))
            });
            var submitSignup =
                function(a) {
                    var c = $(a).find("input").not(".ignore"),
                        b = {},
                        b = $(a).find(".signup__email"),
                        d = $(a).find(".signup__sms");
                    a = encodeURIComponent(b.val());
                    var d = encodeURIComponent(d.val()),
                        e = "none" == b.css("display") ? !0 : !1,
                        b = e ? {
                            phone: d
                        } : {
                            email: a
                        };
                    $.ajax({
                        url: "https://utilities.vioc.com/api/v1/marketing/signup",
                        data: b,
                        dataType: "json",
                        type: "post",
                        beforeSend: function(a) {
                            a.setRequestHeader("Authorization", "Basic Y2F0YWx5c3QtYXBpOmNAdEBseXN0");
                            a.setRequestHeader("Accept", "application/json")
                        },
                        success: function() {
                            e ?
                                $("#smsSuccessModal").modal("show") : $("#emailSuccessModal").modal("show");
                            document.getElementById("signup__input__form").reset();
                            c.hasClass("signup__sms") && ga("send", {
                                hitType: "event",
                                eventCategory: "Signup",
                                eventAction: "sms",
                                eventLabel: "success"
                            });
                            c.hasClass("signup__email") && ga("send", {
                                hitType: "event",
                                eventCategory: "Signup",
                                eventAction: "email",
                                eventLabel: "success"
                            })
                        },
                        error: function() {
                            $("#emailErrorModal").modal("show");
                            c.hasClass("signup__sms") && ga("send", {
                                hitType: "event",
                                eventCategory: "Signup",
                                eventAction: "sms",
                                eventLabel: "error"
                            });
                            c.hasClass("signup__email") && ga("send", {
                                hitType: "event",
                                eventCategory: "Signup",
                                eventAction: "email",
                                eventLabel: "error"
                            })
                        }
                    })
                };
            $("#signup__input__form").validate().settings.submitHandler = function(a) {
                console.log("submit form");
                submitSignup(a)
            }
        };
    </script>
</body>

</html>
